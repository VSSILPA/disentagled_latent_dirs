nohup: ignoring input
StyleGAN2 load fail: No module named 'StyleGAN2'
algo:
  ours:
    batch_size: 8
    deformator_lr: 0.0001
    deformator_type: linear
    initialisation: latent_discovery
    latent_dim: 512
    logging_freq: 500
    model_name: pggan_celebahq1024
    num_directions: 200
    num_steps: 40001
    rank_predictor_lr: 0.0001
    saving_freq: 2000
    shift_min: 10
gan_type: ProgGAN
random_seed: 123
2021-08-20 17:01:24,941 - root - INFO - PerfLog |Fetching data, models and class instantiations|TT:9.49521255493164s
2021-08-20 17:01:27,066 - root - INFO - step : 0 / 40001 Rank predictor loss : 0.6927 Deformator_ranking loss  0.6988 
2021-08-20 17:11:48,625 - root - INFO - step : 500 / 40001 Rank predictor loss : 0.6931 Deformator_ranking loss  0.6937 
2021-08-20 17:22:12,488 - root - INFO - step : 1000 / 40001 Rank predictor loss : 0.6891 Deformator_ranking loss  0.6897 
2021-08-20 17:32:35,901 - root - INFO - step : 1500 / 40001 Rank predictor loss : 0.6876 Deformator_ranking loss  0.6878 
2021-08-20 17:42:58,877 - root - INFO - step : 2000 / 40001 Rank predictor loss : 0.6859 Deformator_ranking loss  0.6867 
2021-08-20 17:42:59,094 - root - INFO - PerfLog |Saving Model|TT:0.2165665626525879s
2021-08-20 17:53:22,229 - root - INFO - step : 2500 / 40001 Rank predictor loss : 0.6843 Deformator_ranking loss  0.6853 
2021-08-20 18:03:45,419 - root - INFO - step : 3000 / 40001 Rank predictor loss : 0.6832 Deformator_ranking loss  0.6840 
2021-08-20 18:14:08,657 - root - INFO - step : 3500 / 40001 Rank predictor loss : 0.6820 Deformator_ranking loss  0.6832 
2021-08-20 18:24:31,974 - root - INFO - step : 4000 / 40001 Rank predictor loss : 0.6811 Deformator_ranking loss  0.6823 
2021-08-20 18:24:32,183 - root - INFO - PerfLog |Saving Model|TT:0.20809721946716309s
2021-08-20 18:34:55,771 - root - INFO - step : 4500 / 40001 Rank predictor loss : 0.6798 Deformator_ranking loss  0.6811 
2021-08-20 18:45:19,041 - root - INFO - step : 5000 / 40001 Rank predictor loss : 0.6787 Deformator_ranking loss  0.6805 
2021-08-20 18:55:42,442 - root - INFO - step : 5500 / 40001 Rank predictor loss : 0.6784 Deformator_ranking loss  0.6793 
2021-08-20 19:06:06,335 - root - INFO - step : 6000 / 40001 Rank predictor loss : 0.6776 Deformator_ranking loss  0.6787 
2021-08-20 19:06:06,549 - root - INFO - PerfLog |Saving Model|TT:0.2142012119293213s
2021-08-20 19:16:29,950 - root - INFO - step : 6500 / 40001 Rank predictor loss : 0.6771 Deformator_ranking loss  0.6780 
2021-08-20 19:26:53,754 - root - INFO - step : 7000 / 40001 Rank predictor loss : 0.6767 Deformator_ranking loss  0.6773 
2021-08-20 19:37:17,195 - root - INFO - step : 7500 / 40001 Rank predictor loss : 0.6754 Deformator_ranking loss  0.6765 
2021-08-20 19:47:41,269 - root - INFO - step : 8000 / 40001 Rank predictor loss : 0.6747 Deformator_ranking loss  0.6760 
2021-08-20 19:47:41,476 - root - INFO - PerfLog |Saving Model|TT:0.20727086067199707s
2021-08-20 19:58:05,109 - root - INFO - step : 8500 / 40001 Rank predictor loss : 0.6741 Deformator_ranking loss  0.6756 
2021-08-20 20:08:28,805 - root - INFO - step : 9000 / 40001 Rank predictor loss : 0.6733 Deformator_ranking loss  0.6752 
2021-08-20 20:18:52,186 - root - INFO - step : 9500 / 40001 Rank predictor loss : 0.6729 Deformator_ranking loss  0.6740 
2021-08-20 20:29:15,546 - root - INFO - step : 10000 / 40001 Rank predictor loss : 0.6730 Deformator_ranking loss  0.6737 
2021-08-20 20:29:15,760 - root - INFO - PerfLog |Saving Model|TT:0.2131359577178955s
2021-08-20 20:39:39,220 - root - INFO - step : 10500 / 40001 Rank predictor loss : 0.6721 Deformator_ranking loss  0.6728 
2021-08-20 20:50:02,941 - root - INFO - step : 11000 / 40001 Rank predictor loss : 0.6713 Deformator_ranking loss  0.6729 
2021-08-20 21:00:26,139 - root - INFO - step : 11500 / 40001 Rank predictor loss : 0.6705 Deformator_ranking loss  0.6709 
2021-08-20 21:10:49,500 - root - INFO - step : 12000 / 40001 Rank predictor loss : 0.6699 Deformator_ranking loss  0.6710 
2021-08-20 21:10:49,715 - root - INFO - PerfLog |Saving Model|TT:0.21473169326782227s
2021-08-20 21:21:13,024 - root - INFO - step : 12500 / 40001 Rank predictor loss : 0.6699 Deformator_ranking loss  0.6702 
nohup: ignoring input
StyleGAN2 load fail: No module named 'StyleGAN2'
algo:
  ours:
    batch_size: 8
    deformator_lr: 0.0001
    deformator_type: linear
    initialisation: latent_discovery
    latent_dim: 512
    logging_freq: 500
    model_name: pggan_celebahq1024
    num_directions: 200
    num_steps: 40001
    rank_predictor_lr: 0.0001
    saving_freq: 2000
    shift_min: 10
gan_type: ProgGAN
random_seed: 123
2021-08-21 02:59:44,175 - root - INFO - PerfLog |Fetching data, models and class instantiations|TT:8.913259983062744s
2021-08-21 03:10:15,617 - root - INFO - step : 12500 / 40001 Rank predictor loss : 0.6699 Deformator_ranking loss  0.6702 
2021-08-21 03:20:48,184 - root - INFO - step : 13000 / 40001 Rank predictor loss : 0.6693 Deformator_ranking loss  0.6703 
2021-08-21 03:31:20,791 - root - INFO - step : 13500 / 40001 Rank predictor loss : 0.6682 Deformator_ranking loss  0.6689 
2021-08-21 03:41:53,584 - root - INFO - step : 14000 / 40001 Rank predictor loss : 0.6675 Deformator_ranking loss  0.6688 
2021-08-21 03:41:53,818 - root - INFO - PerfLog |Saving Model|TT:0.2340996265411377s
2021-08-21 03:52:26,594 - root - INFO - step : 14500 / 40001 Rank predictor loss : 0.6672 Deformator_ranking loss  0.6675 
2021-08-21 04:02:59,220 - root - INFO - step : 15000 / 40001 Rank predictor loss : 0.6663 Deformator_ranking loss  0.6674 
2021-08-21 04:13:31,827 - root - INFO - step : 15500 / 40001 Rank predictor loss : 0.6658 Deformator_ranking loss  0.6665 
2021-08-21 04:24:04,317 - root - INFO - step : 16000 / 40001 Rank predictor loss : 0.6648 Deformator_ranking loss  0.6657 
2021-08-21 04:24:04,546 - root - INFO - PerfLog |Saving Model|TT:0.2288494110107422s
2021-08-21 04:34:37,163 - root - INFO - step : 16500 / 40001 Rank predictor loss : 0.6642 Deformator_ranking loss  0.6653 
2021-08-21 04:45:09,765 - root - INFO - step : 17000 / 40001 Rank predictor loss : 0.6632 Deformator_ranking loss  0.6646 
2021-08-21 04:55:42,307 - root - INFO - step : 17500 / 40001 Rank predictor loss : 0.6630 Deformator_ranking loss  0.6640 
2021-08-21 05:06:15,020 - root - INFO - step : 18000 / 40001 Rank predictor loss : 0.6627 Deformator_ranking loss  0.6628 
2021-08-21 05:06:15,260 - root - INFO - PerfLog |Saving Model|TT:0.23981642723083496s
2021-08-21 05:16:47,871 - root - INFO - step : 18500 / 40001 Rank predictor loss : 0.6621 Deformator_ranking loss  0.6629 
2021-08-21 05:27:20,402 - root - INFO - step : 19000 / 40001 Rank predictor loss : 0.6618 Deformator_ranking loss  0.6621 
2021-08-21 05:37:53,025 - root - INFO - step : 19500 / 40001 Rank predictor loss : 0.6612 Deformator_ranking loss  0.6616 
2021-08-21 05:48:25,561 - root - INFO - step : 20000 / 40001 Rank predictor loss : 0.6598 Deformator_ranking loss  0.6610 
2021-08-21 05:48:25,795 - root - INFO - PerfLog |Saving Model|TT:0.23411297798156738s
nohup: ignoring input
StyleGAN2 load fail: No module named 'StyleGAN2'
Traceback (most recent call last):
  File "evaluation.py", line 238, in <module>
    evaluator.evaluate_directions(deformator, bias, resume=resume, resume_dir=resume_direction)
  File "evaluation.py", line 188, in evaluate_directions
    z = NoiseDataset(latent_codes=codes, num_samples=self.num_samples, z_dim=generator.z_space_dim)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py", line 948, in __getattr__
    type(self).__name__, name))
AttributeError: 'Generator' object has no attribute 'z_space_dim'
nohup: ignoring input
StyleGAN2 load fail: No module named 'StyleGAN2'
Traceback (most recent call last):
  File "evaluation.py", line 238, in <module>
    evaluator.evaluate_directions(deformator, bias, resume=resume, resume_dir=resume_direction)
  File "evaluation.py", line 194, in evaluate_directions
    reference_attr_scores = self.get_reference_attribute_scores(generator, z_loader, self.all_attr_list)
  File "evaluation.py", line 67, in get_reference_attribute_scores
    predictor_list = self._get_predictor_list(attribute_list)
  File "evaluation.py", line 61, in _get_predictor_list
    predictor = attribute_utils.ClassifierWrapper(classifier_name, ckpt_path=self.nvidia_cls_path, device='cuda')
  File "/home/ubuntu/src/disentagled_latent_dirs/src/models/attribute_predictors/attribute_utils.py", line 56, in __init__
    self.net = load_attribute_classifier(classifier_name, ckpt_path).eval().to(device)
  File "/home/ubuntu/src/disentagled_latent_dirs/src/models/attribute_predictors/attribute_utils.py", line 44, in load_attribute_classifier
    ckpt = torch.load(attribute_pkl)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/serialization.py", line 579, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/serialization.py", line 230, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/serialization.py", line 211, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '/home/ubuntu/src/disentagled_latent_dirs/pretrained_models/classifiers/nvidia_classifiers/Bald/net_best.pth'
nohup: ignoring input
StyleGAN2 load fail: No module named 'StyleGAN2'
Using classifier at epoch: 10
Validation acc on raw images: 0.98764
Using classifier at epoch: 20
Validation acc on raw images: 0.95356
Using classifier at epoch: 8
Using classifier at epoch: 5
Validation acc on raw images: 0.96258
Using classifier at epoch: 16
Validation acc on raw images: 0.95089
Using classifier at epoch: 12
Validation acc on raw images: 0.98664
Using classifier at epoch: 17
Validation acc on raw images: 0.95857
Using classifier at epoch: 12
Validation acc on raw images: 0.95991
Using classifier at epoch: 11
Validation acc on raw images: 0.95590
Using classifier at epoch: 8
Validation acc on raw images: 0.97227
Using classifier at epoch: 7
Validation acc on raw images: 0.95289
Using classifier at epoch: 0
Validation acc on raw images: 0.99599
Using classifier at epoch: 12
Validation acc on raw images: 0.94988
INFO:root:PerfLog |Reference attribute scores done|TT:36.58653545379639s
Using classifier at epoch: 10
Validation acc on raw images: 0.98764
Using classifier at epoch: 20
Validation acc on raw images: 0.95356
Using classifier at epoch: 8
Using classifier at epoch: 5
Validation acc on raw images: 0.96258
Using classifier at epoch: 16
Validation acc on raw images: 0.95089
Using classifier at epoch: 12
Validation acc on raw images: 0.98664
Using classifier at epoch: 17
Validation acc on raw images: 0.95857
Using classifier at epoch: 12
Validation acc on raw images: 0.95991
Using classifier at epoch: 11
Validation acc on raw images: 0.95590
Using classifier at epoch: 8
Validation acc on raw images: 0.97227
Using classifier at epoch: 7
Validation acc on raw images: 0.95289
Using classifier at epoch: 0
Validation acc on raw images: 0.99599
Using classifier at epoch: 12
Validation acc on raw images: 0.94988
Traceback (most recent call last):
  File "evaluation.py", line 238, in <module>
    evaluator.evaluate_directions(deformator, bias, resume=resume, resume_dir=resume_direction)
  File "evaluation.py", line 203, in evaluate_directions
    direction_to_resume=resume_dir)
  File "evaluation.py", line 100, in get_evaluation_metric_values
    images_shifted = generator(w_shift)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/src/disentagled_latent_dirs/src/models/latentdiscovery/ProgGAN/model.py", line 108, in forward
    x = self.features(x)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/src/disentagled_latent_dirs/src/models/latentdiscovery/ProgGAN/model.py", line 68, in forward
    x = self.conv(x)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 399, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 396, in _conv_forward
    self.padding, self.dilation, self.groups)
RuntimeError: CUDA out of memory. Tried to allocate 4.02 GiB (GPU 0; 15.78 GiB total capacity; 11.50 GiB already allocated; 2.50 GiB free; 11.83 GiB reserved in total by PyTorch)
nohup: ignoring input
StyleGAN2 load fail: No module named 'StyleGAN2'
Using classifier at epoch: 10
Validation acc on raw images: 0.98764
Using classifier at epoch: 20
Validation acc on raw images: 0.95356
Using classifier at epoch: 8
Using classifier at epoch: 5
Validation acc on raw images: 0.96258
Using classifier at epoch: 16
Validation acc on raw images: 0.95089
Using classifier at epoch: 12
Validation acc on raw images: 0.98664
Using classifier at epoch: 17
Validation acc on raw images: 0.95857
Using classifier at epoch: 12
Validation acc on raw images: 0.95991
Using classifier at epoch: 11
Validation acc on raw images: 0.95590
Using classifier at epoch: 8
Validation acc on raw images: 0.97227
Using classifier at epoch: 7
Validation acc on raw images: 0.95289
Using classifier at epoch: 0
Validation acc on raw images: 0.99599
Using classifier at epoch: 12
Validation acc on raw images: 0.94988
INFO:root:PerfLog |Reference attribute scores done|TT:33.289342403411865s
Using classifier at epoch: 10
Validation acc on raw images: 0.98764
Using classifier at epoch: 20
Validation acc on raw images: 0.95356
Using classifier at epoch: 8
Using classifier at epoch: 5
Validation acc on raw images: 0.96258
Using classifier at epoch: 16
Validation acc on raw images: 0.95089
Using classifier at epoch: 12
Validation acc on raw images: 0.98664
Using classifier at epoch: 17
Validation acc on raw images: 0.95857
Using classifier at epoch: 12
Validation acc on raw images: 0.95991
Using classifier at epoch: 11
Validation acc on raw images: 0.95590
Using classifier at epoch: 8
Validation acc on raw images: 0.97227
Using classifier at epoch: 7
Validation acc on raw images: 0.95289
Using classifier at epoch: 0
Validation acc on raw images: 0.99599
Using classifier at epoch: 12
Validation acc on raw images: 0.94988
torch.Size([8, 512, 1, 1])
torch.Size([1, 512, 1, 1])
torch.Size([8, 512, 1, 512])
Traceback (most recent call last):
  File "evaluation.py", line 241, in <module>
    evaluator.evaluate_directions(deformator, bias, resume=resume, resume_dir=resume_direction)
  File "evaluation.py", line 206, in evaluate_directions
    direction_to_resume=resume_dir)
  File "evaluation.py", line 103, in get_evaluation_metric_values
    images_shifted = generator(w_shift)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/src/disentagled_latent_dirs/src/models/latentdiscovery/ProgGAN/model.py", line 108, in forward
    x = self.features(x)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/container.py", line 119, in forward
    input = module(input)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/src/disentagled_latent_dirs/src/models/latentdiscovery/ProgGAN/model.py", line 68, in forward
    x = self.conv(x)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 399, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/ubuntu/anaconda3/envs/pytorch_latest_p37/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 396, in _conv_forward
    self.padding, self.dilation, self.groups)
RuntimeError: CUDA out of memory. Tried to allocate 4.02 GiB (GPU 0; 15.78 GiB total capacity; 11.50 GiB already allocated; 2.50 GiB free; 11.83 GiB reserved in total by PyTorch)
nohup: ignoring input
StyleGAN2 load fail: No module named 'StyleGAN2'
Using classifier at epoch: 10
Validation acc on raw images: 0.98764
Using classifier at epoch: 20
Validation acc on raw images: 0.95356
Using classifier at epoch: 8
Using classifier at epoch: 5
Validation acc on raw images: 0.96258
Using classifier at epoch: 16
Validation acc on raw images: 0.95089
Using classifier at epoch: 12
Validation acc on raw images: 0.98664
Using classifier at epoch: 17
Validation acc on raw images: 0.95857
Using classifier at epoch: 12
Validation acc on raw images: 0.95991
Using classifier at epoch: 11
Validation acc on raw images: 0.95590
Using classifier at epoch: 8
Validation acc on raw images: 0.97227
Using classifier at epoch: 7
Validation acc on raw images: 0.95289
Using classifier at epoch: 0
Validation acc on raw images: 0.99599
Using classifier at epoch: 12
Validation acc on raw images: 0.94988
INFO:root:PerfLog |Reference attribute scores done|TT:33.298539876937866s
Using classifier at epoch: 10
Validation acc on raw images: 0.98764
Using classifier at epoch: 20
Validation acc on raw images: 0.95356
Using classifier at epoch: 8
Using classifier at epoch: 5
Validation acc on raw images: 0.96258
Using classifier at epoch: 16
Validation acc on raw images: 0.95089
Using classifier at epoch: 12
Validation acc on raw images: 0.98664
Using classifier at epoch: 17
Validation acc on raw images: 0.95857
Using classifier at epoch: 12
Validation acc on raw images: 0.95991
Using classifier at epoch: 11
Validation acc on raw images: 0.95590
Using classifier at epoch: 8
Validation acc on raw images: 0.97227
Using classifier at epoch: 7
Validation acc on raw images: 0.95289
Using classifier at epoch: 0
Validation acc on raw images: 0.99599
Using classifier at epoch: 12
Validation acc on raw images: 0.94988
INFO:root:PerfLog |Direction 0 completed|TT:26.36610460281372s
INFO:root:PerfLog |Direction 1 completed|TT:26.72547197341919s
INFO:root:PerfLog |Direction 2 completed|TT:26.7645320892334s
INFO:root:PerfLog |Direction 3 completed|TT:26.77112317085266s
INFO:root:PerfLog |Direction 4 completed|TT:26.792040824890137s
INFO:root:PerfLog |Direction 5 completed|TT:26.817749500274658s
INFO:root:PerfLog |Direction 6 completed|TT:26.797200679779053s
